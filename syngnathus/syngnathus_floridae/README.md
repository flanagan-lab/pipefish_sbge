# Analysis of sexual selection and sex-biased gene expression in the Dusky pipefish, _Syngnatus floridae_

This folder documents the analysis of selection pressures and gene expression in sexually mature male and female Dusky pipefish.

## Data
The code refers to data that is found in the data/ directory. This data includes:

  - `txi.salmon.floridae.RDS`: This is the gene expression matrix that is generated at the end of the RNA-seq pipeline and used for differential expression analysis with DESeq2. This file was generated from the salmon `quant.sf` files with the package tximport.
    
  - `floridae_expression_files`: This folder contains all of the quant.sf files that were generated by salmon for each sample.
    
  - `all_fem_meso_floridae.csv` and `all_mal_meso_floridae.csv`: These files contain the data about the morphometrics of all male and female pipefish and various information relating to the trials they were in.

  - `EmbryoParentage.csv`: This is the file that is used to calculate reproductive fitness and mating success for male and female pipefish.

### Data availability
The raw data that corresponds to the analyses highlighted in this directory have been archived. The raw RNA-sequencing reads and sample meta-data are deposited in the NCBI Short Read Archive (BioProject PRJNA1062454) and the microsatellite genotyping data is archived with the data on individual traits and reproductive success on zenodo (doi: 10.5281/zenodo.10558631).

## Navigating this repository
All Rmarkdown documents used for the various analyses are located in the directory docs/. They do the following things:

  - `Analyzing_floridae_RNAseq_data_from_MSU.Rmd`: Works through the entire RNA-sequencing pipeline starting with the raw reads, moving through pre-assembly quality control, _de novo_ assembly generation, post-assembly quality control and thinning, and alignment and abundance estimations. The programs used for each step and how each program was used is highlighted in detail within the document, along with the results of the various steps. The end file generated from this document is a .RDS gene expression matrix that was then used for differential expression analysis.

  - `floridae_diff_expr_analysis.Rmd`: Read in the .RDS file, perform some exploratory analysis, including a single-factor analysis that looked at MvF gene expression across all organs, and then a detailed multi-factor analysis that explored MvF expression levels within each organ. This file generates all of the datasets that were then used to create figures 2 and 3 for the manuscript as well as results for the Gene ontology analysis.

  - `floridae_tissue_specificity.Rmd`: Read in the quant.sf files generated from salmon to calculate the tissue specificity index tau ($tau$) for all genes. This file includes the filtering of genes and function that was used to calculate tau. Additionally, this file contains the comparisson analysis of tau vs sex-bias and generates the data that was used to create figure 4 in the manuscript.

  - `selection_analysis_floridae.Rmd`: Read in the corresponding datasets, calculate reproductive and mating fitness based on the embryo parentage data, calculate summary statistics for males and females, and lastly quantify selection in terms of opportunity for selection, selection differentials, and Bateman's gradient for males and females. This file generates the data used to create figure 1 in the manuscript.

  - `Creating_figures_floridae_ms.Rmd`: For each of the figures presented in the associated manuscript read in the corresponding data, perform any reorganization or additional analyses, and generate the figure.

All bash scripts that correspond with any .Rmd documents can be found in the bash/ directory.

### R
The directory R/ contains the script that was used to convert the results from the genetic parentage analysis into overall mating and reproductive success and the script that was used to generate the BUSCO plot.

